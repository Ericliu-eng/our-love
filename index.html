<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Interactive Love â¤ï¸</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: sans-serif; }
        canvas { position: absolute; top: 0; left: 0; }
        
        .ui-layer {
            position: relative;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            pointer-events: none;
        }

        .card {
            text-align: center;
            background: rgba(255, 255, 255, 0.15);
            padding: 30px;
            border-radius: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 80%;
            max-width: 320px;
            pointer-events: auto;
            box-shadow: 0 0 30px rgba(255,107,129,0.3);
        }

        .days-num { font-size: 3.5rem; font-weight: bold; color: #ff6b81; }
        .time-detail { font-size: 1rem; margin: 15px 0; color: #eee; }
        .footer { font-size: 0.8rem; opacity: 0.6; letter-spacing: 2px; }
        .hint { position: absolute; bottom: 20px; color: rgba(255,255,255,0.4); font-size: 0.7rem; }

        /* --- æ–°å¢èŠå¤©ç•Œé¢æ ·å¼ --- */
        #chat-container {
            position: fixed;
            bottom: 85px;
            right: 20px;
            width: 280px;
            height: 380px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
            flex-direction: column;
            z-index: 100;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            pointer-events: auto;
        }

        #chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            color: white;
            font-size: 0.9rem;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-wrap: break-word; line-height: 1.4; }
        .ai-msg { background: rgba(255, 107, 129, 0.2); align-self: flex-start; border-bottom-left-radius: 2px; }
        .user-msg { background: rgba(255, 255, 255, 0.2); align-self: flex-end; border-bottom-right-radius: 2px; }

        #chat-input-area { display: flex; padding: 12px; background: rgba(0, 0, 0, 0.3); border-top: 1px solid rgba(255,255,255,0.1); }
        #chat-input { flex: 1; background: transparent; border: none; color: white; outline: none; font-size: 0.9rem; }
        
        #chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 55px;
            height: 55px;
            background: #ff6b81;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 101;
            box-shadow: 0 5px 15px rgba(255,107,129,0.4);
            pointer-events: auto;
            font-size: 24px;
            transition: transform 0.3s;
        }
        #chat-toggle:active { transform: scale(0.9); }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div class="ui-layer">
        <div class="card">
            <div style="font-size: 40px;">ğŸ’–</div>
            <div style="margin-top:10px; opacity:0.9;">Z & L</div>
            <div class="days-num" id="days">0</div>
            <div style="font-size:1.2rem; color:#ff6b81; margin-bottom:10px;">DAYS</div>
            <div id="time" class="time-detail">00:00:00</div>
            <div class="footer">SINCE 2025.12.07</div>
        </div>
        <div class="hint">æ»‘åŠ¨å±å¹•è¯•è¯•çœ‹ï¼Œä¼šæœ‰æ˜Ÿå…‰è·Ÿç€ä½  âœ¨</div>
    </div>

    <div id="chat-toggle" onclick="toggleChat()">ğŸ’¬</div>

    <div id="chat-container">
        <div style="padding:12px; text-align:center; font-size:0.8rem; background:rgba(255,107,129,0.3); color:white; letter-spacing:1px;">AI æ‹çˆ±è§è¯å®˜</div>
        <div id="chat-messages">
            <div class="message ai-msg">ä½ å¥½ï¼Œæˆ‘æ˜¯ Z & L çš„ä¸“å± AIã€‚ä»Šå¤©æœ‰ä»€ä¹ˆæƒ³èŠçš„å—ï¼Ÿ</div>
        </div>
        <div id="chat-input-area">
            <input type="text" id="chat-input" placeholder="å†™ä¸‹æƒ³è¯´çš„è¯..." onkeypress="if(event.key==='Enter') sendMessage()">
            <div onclick="sendMessage()" style="color:#ff6b81; cursor:pointer; margin-left:10px; font-weight:bold;">å‘é€</div>
        </div>
    </div>

<script>
    /* --- 1. é…ç½®åŒº --- */
    const GEMINI_API_KEY = "AIzaSyDKgVqim9wh9Ux9qJYXfSH3SMyxs-fcy0g"; 
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

    /* --- 2. åŸæœ‰ç²’å­èƒŒæ™¯é€»è¾‘ --- */
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize;
    resize();

    class Particle {
        constructor(x, y, color) {
            this.x = x; this.y = y;
            this.size = Math.random() * 5 + 2;
            this.speedX = Math.random() * 3 - 1.5;
            this.speedY = Math.random() * 3 - 1.5;
            this.color = color;
            this.opacity = 1;
        }
        update() { this.x += this.speedX; this.y += this.speedY; this.opacity -= 0.02; }
        draw() {
            ctx.fillStyle = this.color.replace(')', `, ${this.opacity})`).replace('rgb', 'rgba');
            ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
        }
    }

    function createParticles(e) {
        const x = e.touches ? e.touches[0].clientX : e.clientX;
        const y = e.touches ? e.touches[0].clientY : e.clientY;
        const color = `rgb(255, ${Math.random()*100+100}, ${Math.random()*100+150})`;
        for(let i=0; i<3; i++) particles.push(new Particle(x, y, color));
    }
    window.addEventListener('mousemove', createParticles);
    window.addEventListener('touchmove', createParticles);
    window.addEventListener('mousedown', createParticles);

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for(let i = 0; i < particles.length; i++) {
            particles[i].update(); particles[i].draw();
            if(particles[i].opacity <= 0) { particles.splice(i, 1); i--; }
        }
        requestAnimationFrame(animate);
    }
    animate();

    /* --- 3. æ‹çˆ±è®¡æ—¶é€»è¾‘ --- */
    function updateTimer() {
        const start = new Date('2025-12-07T00:00:00');
        const now = new Date();
        const diff = now - start;
        const d = Math.floor(diff / 86400000);
        const h = Math.floor((diff / 3600000) % 24);
        const m = Math.floor((diff / 60000) % 60);
        const s = Math.floor((diff / 1000) % 60);
        document.getElementById('days').innerText = d;
        document.getElementById('time').innerText = `${h<10?'0'+h:h}h ${m<10?'0'+m:m}m ${s<10?'0'+s:s}s`;
    }
    setInterval(updateTimer, 1000);
    updateTimer();

    /* --- 4. æ–°å¢ AI èŠå¤©é€»è¾‘ --- */
    function toggleChat() {
        const chat = document.getElementById('chat-container');
        chat.style.display = (chat.style.display === 'flex') ? 'none' : 'flex';
    }

    async function sendMessage() {
        const input = document.getElementById('chat-input');
        const text = input.value.trim();
        if(!text) return;

        addMessage(text, 'user-msg');
        input.value = '';

        const tempId = 'ai-' + Date.now();
        addMessage("æ€è€ƒä¸­...", 'ai-msg', tempId);

        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: `
                        ä½ æ˜¯ä¸€ä¸ªæ¸©æŸ”çš„æ‹çˆ±è§è¯å®˜ã€‚
                        èƒŒæ™¯ï¼šZ å’Œ L åœ¨ä¸€èµ·å·²ç» ${document.getElementById('days').innerText} å¤©äº†ã€‚
                        è¦æ±‚ï¼šç”¨æ¸©æš–ã€æ„Ÿæ€§ä¸”ç®€çŸ­çš„è¯­è¨€å›å¤ï¼ˆ2-3å¥è¯ï¼‰ï¼Œå¯ä»¥ç”¨ä¸­è‹±æ–‡ã€‚
                        ç”¨æˆ·è¯´ï¼š${text}` 
                    }]}]
                })
            });
            const data = await response.json();
            const reply = data.candidates[0].content.parts[0].text;
            document.getElementById(tempId).innerText = reply;
        } catch (err) {
            document.getElementById(tempId).innerText = "æ˜Ÿç©ºä¿¡å·æœ‰ç‚¹å¼±ï¼Œè¯·ç¨åå†è¯•ã€‚";
        }
    }

    function addMessage(text, type, id) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `message ${type}`;
        if(id) msgDiv.id = id;
        msgDiv.innerText = text;
        const box = document.getElementById('chat-messages');
        box.appendChild(msgDiv);
        box.scrollTop = box.scrollHeight;
    }
</script>
</body>
</html>
